# Copyright 2012 Michael Thomas
# Distributed under the terms of the GNU General Public License v2
# Based in part upon 'scons.exlib', which is:
#     Copyright 2009 Ingmar Vanhassel

export_exlib_phases src_configure src_compile

DEPENDENCIES="
    build:
        sys-devel/scons
"

escons() {
    illegal_in_global_scope

    edo scons "${@}"
}

scons_src_configure() {
    :
}

scons_src_compile() {
    escons \
        --jobs ${EXJOBS:-1} \
        CFLAGS="${CFLAGS}" \
        CXXFLAGS="${CXXFLAGS}" \
        LDFLAGS="${LDFLAGS}" \
        "${SCONS_SRC_COMPILE_PARAMS[@]}"
        "${@}"
}

scons_src_install() {
    escons \
        --config=cache \
        DESTDIR="${IMAGE}" \
        "${SCONS_SRC_INSTALL_PARAMS[@]}" \
        install
}
